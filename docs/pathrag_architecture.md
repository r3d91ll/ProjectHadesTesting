# PathRAG Architecture

This document provides a visual representation of the PathRAG architecture and workflow.

## High-Level Architecture

```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│                        PathRAG System                               │
│                                                                     │
│  ┌───────────┐     ┌───────────┐     ┌───────────┐     ┌──────────┐ │
│  │           │     │           │     │           │     │          │ │
│  │  Query    │────▶│  Path     │────▶│  Context  │────▶│  LLM     │ │
│  │  Parser   │     │  Finder   │     │  Builder  │     │  Gen     │ │
│  │           │     │           │     │           │     │          │ │
│  └───────────┘     └───────────┘     └───────────┘     └──────────┘ │
│        │                 │                 │                 │      │
│        ▼                 ▼                 ▼                 ▼      │
│  ┌───────────┐     ┌───────────┐     ┌───────────┐     ┌──────────┐ │
│  │           │     │           │     │           │     │          │ │
│  │  Entity   │     │  Graph    │     │  Document │     │ Response │ │
│  │  Extractor│     │  Database │     │  Store    │     │ Formatter│ │
│  │           │     │           │     │           │     │          │ │
│  └───────────┘     └───────────┘     └───────────┘     └──────────┘ │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
                               │
                               ▼
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│                   Monitoring & Evaluation                           │
│                                                                     │
│  ┌───────────┐     ┌───────────┐     ┌───────────┐     ┌──────────┐ │
│  │           │     │           │     │           │     │          │ │
│  │  GPU      │     │  Arize    │     │  Metrics  │     │  Grafana │ │
│  │  Exporter │     │  Phoenix  │     │  Collector│     │  Dash    │ │
│  │           │     │           │     │           │     │          │ │
│  └───────────┘     └───────────┘     └───────────┘     └──────────┘ │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

## PathRAG Workflow

```
┌─────────────┐       ┌─────────────┐       ┌─────────────┐       ┌─────────────┐
│             │       │             │       │             │       │             │
│  User       │       │  Entity     │       │  Graph      │       │  Document   │
│  Query      │──────▶│  Extraction │──────▶│  Path       │──────▶│  Retrieval  │
│             │       │             │       │  Finding    │       │             │
└─────────────┘       └─────────────┘       └─────────────┘       └─────────────┘
                                                                         │
                                                                         ▼
┌─────────────┐       ┌─────────────┐       ┌─────────────┐       ┌─────────────┐
│             │       │             │       │             │       │             │
│  Response   │       │  LLM        │       │  Context    │       │  Document   │
│  to User    │◀──────│  Generation │◀──────│  Formation  │◀──────│  Ranking    │
│             │       │             │       │             │       │             │
└─────────────┘       └─────────────┘       └─────────────┘       └─────────────┘
```

## Implementation Variants

```
┌──────────────────────────────────────────────────────────────────────────────┐
│                                                                              │
│                    PathRAG Implementation Variants                           │
│                                                                              │
│  ┌────────────────────┐    ┌────────────────────┐    ┌────────────────────┐  │
│  │                    │    │                    │    │                    │  │
│  │  Original PathRAG  │    │  Qwen25 PathRAG    │    │  XnX PathRAG       │  │
│  │  ┌──────────────┐  │    │  ┌──────────────┐  │    │  ┌──────────────┐  │  │
│  │  │ OpenAI API   │  │    │  │ Local Qwen25 │  │    │  │ XnX Notation │  │  │
│  │  │ Integration  │  │    │  │ Model        │  │    │  │ Integration  │  │  │
│  │  └──────────────┘  │    │  └──────────────┘  │    │  └──────────────┘  │  │
│  │  ┌──────────────┐  │    │  ┌──────────────┐  │    │  ┌──────────────┐  │  │
│  │  │ Cloud-Based  │  │    │  │ On-Premises  │  │    │  │ Enhanced     │  │  │
│  │  │ Inference    │  │    │  │ Inference    │  │    │  │ Reasoning    │  │  │
│  │  └──────────────┘  │    │  └──────────────┘  │    │  └──────────────┘  │  │
│  │                    │    │                    │    │                    │  │
│  └────────────────────┘    └────────────────────┘    └────────────────────┘  │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘
```

## GPU Monitoring Integration

```
┌────────────────────────────────────────────────────────────────────────────┐
│                                                                            │
│                         GPU Monitoring System                              │
│                                                                            │
│  ┌────────────────┐     ┌────────────────┐     ┌────────────────┐          │
│  │                │     │                │     │                │          │
│  │  Python GPU    │────▶│  Prometheus    │────▶│  Grafana       │          │
│  │  Exporter      │     │  Time Series   │     │  Dashboards    │          │
│  │                │     │                │     │                │          │
│  └────────────────┘     └────────────────┘     └────────────────┘          │
│         ▲                                              │                   │
│         │                                              │                   │
│         │                                              ▼                   │
│  ┌────────────────┐                          ┌────────────────┐            │
│  │                │                          │                │            │
│  │  NVIDIA        │                          │  Performance   │            │
│  │  RTX A6000 GPUs│                          │  Analytics     │            │
│  │                │                          │                │            │
│  └────────────────┘                          └────────────────┘            │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

## Data Flow for PathRAG with GPU Monitoring

```
┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐
│          │    │          │    │          │    │          │    │          │
│  User    │───▶│  PathRAG │───▶│  Qwen25  │───▶│  GPU     │───▶│  Metrics │
│  Query   │    │  System  │    │  Model   │    │  Usage   │    │  Capture │
│          │    │          │    │          │    │          │    │          │
└──────────┘    └──────────┘    └──────────┘    └──────────┘    └──────────┘
                                                                      │
                                                                      ▼
┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐
│          │    │          │    │          │    │          │    │          │
│  User    │◀───│  Answer  │◀───│  Response│◀───│  Arize   │◀───│  Grafana │
│          │    │  Display │    │  Assembly│    │  Phoenix │    │  Viz     │
│          │    │          │    │          │    │          │    │          │
└──────────┘    └──────────┘    └──────────┘    └──────────┘    └──────────┘
```

## Components Detailed View

### Query Processing

```
┌───────────────────────────────────────────────────────────────┐
│                                                               │
│                      Query Processing                         │
│                                                               │
│  ┌────────────┐    ┌────────────┐    ┌────────────┐           │
│  │            │    │            │    │            │           │
│  │  Entity    │───▶│  Relation  │───▶│  Query     │           │
│  │  Detection │    │  Mapping   │    │  Expansion │           │
│  │            │    │            │    │            │           │
│  └────────────┘    └────────────┘    └────────────┘           │
│                                                               │
└───────────────────────────────────────────────────────────────┘
```

### Path Finding

```
┌───────────────────────────────────────────────────────────────┐
│                                                               │
│                      Path Finding                             │
│                                                               │
│  ┌────────────┐    ┌────────────┐    ┌────────────┐           │
│  │            │    │            │    │            │           │
│  │  Graph     │───▶│  Path      │───▶│  Path      │           │
│  │  Query     │    │  Generation│    │  Ranking   │           │
│  │            │    │            │    │            │           │
│  └────────────┘    └────────────┘    └────────────┘           │
│                                                               │
└───────────────────────────────────────────────────────────────┘
```

### LLM Generation

```
┌───────────────────────────────────────────────────────────────┐
│                                                               │
│                      LLM Generation                           │
│                                                               │
│  ┌────────────┐    ┌────────────┐    ┌────────────┐           │
│  │            │    │            │    │            │           │
│  │  Prompt    │───▶│  Model     │───▶│  Response  │           │
│  │  Assembly  │    │  Inference │    │  Parsing   │           │
│  │            │    │            │    │            │           │
│  └────────────┘    └────────────┘    └────────────┘           │
│                                                               │
└───────────────────────────────────────────────────────────────┘
```
